#!/usr/bin/env bash
set -u

export MOCK_RAYLIB=1

log() {
  echo "[ $0 ] $@"
}

log "Building Taylor"
bundle exec rake windows:release:build || exit 1

pushd test/

log "Running tests"
wine ../dist/windows/release/taylor.exe ../cli-tool/cli.rb test.rb 2> /dev/null
EXIT_CODE=$?

popd
exit $EXIT_CODE
