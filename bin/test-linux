#!/usr/bin/env bash
set -euo pipefail

DIRNAME=$(dirname -- "${0}")
SCRIPT_DIR=$(cd -- "${DIRNAME}" > /dev/null 2>&1 && pwd)
source "${SCRIPT_DIR}"/shared.lib.sh

export MOCK_RAYLIB=1

log "Building Taylor"
bundle exec rake linux:release:build &> /dev/null || exit 1

pushd test/ &> /dev/null

log "Running tests"
../dist/linux/release/taylor ../cli-tool/cli.rb test.rb
